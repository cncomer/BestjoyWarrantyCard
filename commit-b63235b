commit b63235b9aa9be5b441b4f296966adff3e4df66e9
Author: chenkai <chenkai@huaqin.com>
Date:   Mon Apr 21 21:47:15 2014 +0800

    修改登录方式

diff --git a/AndroidManifest.xml b/AndroidManifest.xml
index bf1df6a..1542470 100644
--- a/AndroidManifest.xml
+++ b/AndroidManifest.xml
@@ -107,8 +107,13 @@
         <activity
             android:name="com.bestjoy.app.haierwarrantycard.ui.CaptureActivity"
             android:excludeFromRecents="true"
-            android:launchMode="singleTop"
-            android:screenOrientation="portrait"/>
+            android:theme="@android:style/Theme.NoTitleBar.Fullscreen"
+            android:launchMode="singleTop"/>
+        <activity
+            android:name="com.bestjoy.app.haierwarrantycard.ui.LoginOrUpdateAccountDialog"
+            android:excludeFromRecents="true"
+            android:theme="@android:style/Theme.Dialog"
+            android:launchMode="singleTop"/>
         
         <provider android:name="com.bestjoy.app.haierwarrantycard.database.BjnoteProvider"
             android:exported="true"
diff --git a/gen/com/bestjoy/app/haierwarrantycard/R.java b/gen/com/bestjoy/app/haierwarrantycard/R.java
index a205a36..13dd992 100644
--- a/gen/com/bestjoy/app/haierwarrantycard/R.java
+++ b/gen/com/bestjoy/app/haierwarrantycard/R.java
@@ -1114,10 +1114,10 @@ containing a value of this type.
         public static final int arrow_l_on=0x7f020074;
         public static final int arrow_r=0x7f020075;
         public static final int arrow_r_on=0x7f020076;
-        public static final int button_black=0x7f0200ba;
-        public static final int button_black_on=0x7f0200bb;
-        public static final int button_pink=0x7f0200bc;
-        public static final int button_pink_on=0x7f0200bd;
+        public static final int button_black=0x7f0200bb;
+        public static final int button_black_on=0x7f0200bc;
+        public static final int button_pink=0x7f0200bd;
+        public static final int button_pink_on=0x7f0200be;
         public static final int dashboard=0x7f020077;
         public static final int dashboard_bg=0x7f020078;
         public static final int dashboard_my_card=0x7f020079;
@@ -1142,49 +1142,50 @@ containing a value of this type.
         public static final int flag_arrow_r=0x7f02008c;
         public static final int flag_repair=0x7f02008d;
         public static final int ic_camera=0x7f02008e;
-        public static final int ic_launcher=0x7f02008f;
-        public static final int ic_menu_sort_by_size=0x7f020090;
-        public static final int ic_settings=0x7f020091;
-        public static final int ic_voice=0x7f020092;
-        public static final int login_top_title=0x7f020093;
-        public static final int model_feedback=0x7f020094;
-        public static final int model_install=0x7f020095;
-        public static final int model_my_card=0x7f020096;
-        public static final int model_repair=0x7f020097;
-        public static final int shadow=0x7f020098;
-        public static final int shopper_icon=0x7f020099;
-        public static final int textfield_activated_holo_dark=0x7f02009a;
-        public static final int textfield_activated_holo_light=0x7f02009b;
-        public static final int textfield_bg_activated_holo_dark=0x7f02009c;
-        public static final int textfield_bg_default_holo_dark=0x7f02009d;
-        public static final int textfield_bg_disabled_focused_holo_dark=0x7f02009e;
-        public static final int textfield_bg_disabled_holo_dark=0x7f02009f;
-        public static final int textfield_bg_focused_holo_dark=0x7f0200a0;
-        public static final int textfield_default_holo_dark=0x7f0200a1;
-        public static final int textfield_default_holo_light=0x7f0200a2;
-        public static final int textfield_disabled_focused_holo_dark=0x7f0200a3;
-        public static final int textfield_disabled_focused_holo_light=0x7f0200a4;
-        public static final int textfield_disabled_holo_dark=0x7f0200a5;
-        public static final int textfield_disabled_holo_light=0x7f0200a6;
-        public static final int textfield_focused_holo_dark=0x7f0200a7;
-        public static final int textfield_focused_holo_light=0x7f0200a8;
-        public static final int textfield_multiline_activated_holo_dark=0x7f0200a9;
-        public static final int textfield_multiline_activated_holo_light=0x7f0200aa;
-        public static final int textfield_multiline_default_holo_dark=0x7f0200ab;
-        public static final int textfield_multiline_default_holo_light=0x7f0200ac;
-        public static final int textfield_multiline_disabled_focused_holo_dark=0x7f0200ad;
-        public static final int textfield_multiline_disabled_focused_holo_light=0x7f0200ae;
-        public static final int textfield_multiline_disabled_holo_dark=0x7f0200af;
-        public static final int textfield_multiline_disabled_holo_light=0x7f0200b0;
-        public static final int textfield_multiline_focused_holo_dark=0x7f0200b1;
-        public static final int textfield_multiline_focused_holo_light=0x7f0200b2;
-        public static final int title_scan_qr=0x7f0200b3;
-        public static final int top=0x7f0200b4;
-        public static final int top1=0x7f0200b5;
-        public static final int top_arraw_l=0x7f0200b6;
-        public static final int top_arraw_l_on=0x7f0200b7;
-        public static final int top_arrow_left_btn=0x7f0200b8;
-        public static final int top_title_bg=0x7f0200b9;
+        public static final int ic_camera_black=0x7f02008f;
+        public static final int ic_launcher=0x7f020090;
+        public static final int ic_menu_sort_by_size=0x7f020091;
+        public static final int ic_settings=0x7f020092;
+        public static final int ic_voice=0x7f020093;
+        public static final int login_top_title=0x7f020094;
+        public static final int model_feedback=0x7f020095;
+        public static final int model_install=0x7f020096;
+        public static final int model_my_card=0x7f020097;
+        public static final int model_repair=0x7f020098;
+        public static final int shadow=0x7f020099;
+        public static final int shopper_icon=0x7f02009a;
+        public static final int textfield_activated_holo_dark=0x7f02009b;
+        public static final int textfield_activated_holo_light=0x7f02009c;
+        public static final int textfield_bg_activated_holo_dark=0x7f02009d;
+        public static final int textfield_bg_default_holo_dark=0x7f02009e;
+        public static final int textfield_bg_disabled_focused_holo_dark=0x7f02009f;
+        public static final int textfield_bg_disabled_holo_dark=0x7f0200a0;
+        public static final int textfield_bg_focused_holo_dark=0x7f0200a1;
+        public static final int textfield_default_holo_dark=0x7f0200a2;
+        public static final int textfield_default_holo_light=0x7f0200a3;
+        public static final int textfield_disabled_focused_holo_dark=0x7f0200a4;
+        public static final int textfield_disabled_focused_holo_light=0x7f0200a5;
+        public static final int textfield_disabled_holo_dark=0x7f0200a6;
+        public static final int textfield_disabled_holo_light=0x7f0200a7;
+        public static final int textfield_focused_holo_dark=0x7f0200a8;
+        public static final int textfield_focused_holo_light=0x7f0200a9;
+        public static final int textfield_multiline_activated_holo_dark=0x7f0200aa;
+        public static final int textfield_multiline_activated_holo_light=0x7f0200ab;
+        public static final int textfield_multiline_default_holo_dark=0x7f0200ac;
+        public static final int textfield_multiline_default_holo_light=0x7f0200ad;
+        public static final int textfield_multiline_disabled_focused_holo_dark=0x7f0200ae;
+        public static final int textfield_multiline_disabled_focused_holo_light=0x7f0200af;
+        public static final int textfield_multiline_disabled_holo_dark=0x7f0200b0;
+        public static final int textfield_multiline_disabled_holo_light=0x7f0200b1;
+        public static final int textfield_multiline_focused_holo_dark=0x7f0200b2;
+        public static final int textfield_multiline_focused_holo_light=0x7f0200b3;
+        public static final int title_scan_qr=0x7f0200b4;
+        public static final int top=0x7f0200b5;
+        public static final int top1=0x7f0200b6;
+        public static final int top_arraw_l=0x7f0200b7;
+        public static final int top_arraw_l_on=0x7f0200b8;
+        public static final int top_arrow_left_btn=0x7f0200b9;
+        public static final int top_title_bg=0x7f0200ba;
     }
     public static final class id {
         public static final int abs__action_bar=0x7f060036;
@@ -1226,113 +1227,116 @@ containing a value of this type.
         public static final int abs__textButton=0x7f060029;
         public static final int abs__title=0x7f060031;
         public static final int abs__up=0x7f06000b;
-        public static final int address=0x7f06009d;
-        public static final int adsViewPager=0x7f060067;
+        public static final int address=0x7f0600a0;
+        public static final int adsViewPager=0x7f06006a;
         public static final int auto_focus=0x7f06001a;
-        public static final int avator=0x7f060077;
-        public static final int barcode_image_view=0x7f060080;
-        public static final int bottom_layout=0x7f06006b;
-        public static final int brand=0x7f060092;
-        public static final int button_back=0x7f06008a;
-        public static final int button_call_repair=0x7f060079;
-        public static final int button_getyanzhengma=0x7f060073;
+        public static final int avator=0x7f06007a;
+        public static final int barcode_image_view=0x7f060083;
+        public static final int bottom_layout=0x7f06006e;
+        public static final int brand=0x7f060095;
+        public static final int button_back=0x7f06008d;
+        public static final int button_call_repair=0x7f06007c;
+        public static final int button_getyanzhengma=0x7f060076;
         public static final int button_login=0x7f06005f;
-        public static final int button_my_card=0x7f06008e;
-        public static final int button_new_card=0x7f06008d;
-        public static final int button_next=0x7f060075;
-        public static final int button_qa=0x7f060078;
+        public static final int button_my_card=0x7f060091;
+        public static final int button_new_card=0x7f060090;
+        public static final int button_next=0x7f060078;
+        public static final int button_qa=0x7f06007b;
         public static final int button_register=0x7f060060;
-        public static final int button_repair=0x7f06008f;
-        public static final int button_right=0x7f06008b;
+        public static final int button_repair=0x7f060092;
+        public static final int button_right=0x7f06008e;
         public static final int button_save=0x7f060052;
-        public static final int button_scan=0x7f06006c;
-        public static final int button_speak=0x7f06007c;
-        public static final int button_speek=0x7f06007b;
-        public static final int check_protocol=0x7f060074;
-        public static final int checkbox=0x7f060096;
-        public static final int content_frame=0x7f06008c;
-        public static final int contents_text_view=0x7f060083;
-        public static final int date_picker=0x7f06006e;
-        public static final int day=0x7f060095;
-        public static final int deadline=0x7f060090;
+        public static final int button_scan_bill=0x7f060070;
+        public static final int button_scan_qrcode=0x7f06006f;
+        public static final int button_speak=0x7f06007f;
+        public static final int button_speek=0x7f06007e;
+        public static final int check_protocol=0x7f060077;
+        public static final int checkbox=0x7f060099;
+        public static final int content_frame=0x7f06008f;
+        public static final int contents_text_view=0x7f060086;
+        public static final int day=0x7f060098;
+        public static final int deadline=0x7f060093;
         public static final int decode=0x7f06001b;
         public static final int decode_failed=0x7f06001c;
         public static final int decode_succeeded=0x7f06001d;
         public static final int disableHome=0x7f060009;
-        public static final int dots=0x7f060069;
-        public static final int edit_city=0x7f0600a3;
+        public static final int dots=0x7f06006c;
+        public static final int edit_city=0x7f0600a6;
         public static final int edit_city_1=0x7f06004a;
         public static final int edit_city_2=0x7f06004d;
         public static final int edit_city_3=0x7f060050;
-        public static final int edit_district=0x7f0600a4;
+        public static final int edit_district=0x7f0600a7;
         public static final int edit_district_1=0x7f06004b;
         public static final int edit_district_2=0x7f06004e;
         public static final int edit_district_3=0x7f060051;
-        public static final int edit_province=0x7f0600a2;
+        public static final int edit_province=0x7f0600a5;
         public static final int edit_province_1=0x7f060049;
         public static final int edit_province_2=0x7f06004c;
         public static final int edit_province_3=0x7f06004f;
         public static final int edit_query=0x7f06003c;
         public static final int encode_failed=0x7f06001e;
         public static final int encode_succeeded=0x7f06001f;
-        public static final int flag=0x7f0600aa;
-        public static final int format_text_view=0x7f060081;
+        public static final int flag=0x7f0600ad;
+        public static final int format_text_view=0x7f060084;
         public static final int fullscreen=0x7f060013;
-        public static final int gridview=0x7f06009e;
-        public static final int history_detail=0x7f060098;
-        public static final int history_title=0x7f060097;
+        public static final int gridview=0x7f0600a1;
+        public static final int history_detail=0x7f06009b;
+        public static final int history_title=0x7f06009a;
+        public static final int home1=0x7f060061;
+        public static final int home2=0x7f060062;
+        public static final int home3=0x7f060063;
         public static final int homeAsUp=0x7f060006;
-        public static final int homeName=0x7f060099;
-        public static final int input_city=0x7f06009b;
-        public static final int input_district=0x7f06009c;
-        public static final int input_province=0x7f06009a;
+        public static final int homeName=0x7f06009c;
+        public static final int input_city=0x7f06009e;
+        public static final int input_district=0x7f06009f;
+        public static final int input_province=0x7f06009d;
         public static final int launch_product_query=0x7f060020;
         public static final int left=0x7f060010;
         public static final int letterBar=0x7f060058;
-        public static final int line=0x7f06006a;
+        public static final int line=0x7f06006d;
         public static final int listMode=0x7f060002;
         public static final int listview=0x7f060053;
         public static final int margin=0x7f060012;
-        public static final int menu_frame=0x7f06009f;
-        public static final int model=0x7f060093;
+        public static final int menu_frame=0x7f0600a2;
+        public static final int model=0x7f060096;
         public static final int model_feedback=0x7f060019;
-        public static final int model_flag=0x7f060094;
-        public static final int model_icon=0x7f0600a0;
+        public static final int model_flag=0x7f060097;
+        public static final int model_icon=0x7f0600a3;
         public static final int model_install=0x7f060017;
         public static final int model_my_card=0x7f060016;
-        public static final int model_name=0x7f0600a1;
+        public static final int model_name=0x7f0600a4;
         public static final int model_repair=0x7f060018;
-        public static final int name=0x7f060091;
+        public static final int name=0x7f060094;
         public static final int none=0x7f060014;
         public static final int normal=0x7f060001;
         public static final int pagerview=0x7f060056;
-        public static final int placeholder=0x7f060068;
-        public static final int preview_view=0x7f06007d;
-        public static final int product=0x7f060076;
-        public static final int product_ask_online_input=0x7f06007a;
-        public static final int product_brand=0x7f0600ab;
-        public static final int product_brand_input=0x7f0600a5;
-        public static final int product_buy_cost=0x7f06006f;
-        public static final int product_buy_date=0x7f06006d;
-        public static final int product_buy_delay_componey=0x7f060071;
-        public static final int product_buy_delay_componey_tel=0x7f060072;
-        public static final int product_buy_delay_time=0x7f060070;
+        public static final int placeholder=0x7f06006b;
+        public static final int preview_view=0x7f060080;
+        public static final int product=0x7f060079;
+        public static final int product_ask_online_input=0x7f06007d;
+        public static final int product_brand=0x7f0600ae;
+        public static final int product_brand_input=0x7f0600a8;
+        public static final int product_buy_cost=0x7f060072;
+        public static final int product_buy_date=0x7f060071;
+        public static final int product_buy_delay_componey=0x7f060074;
+        public static final int product_buy_delay_componey_tel=0x7f060075;
+        public static final int product_buy_delay_time=0x7f060073;
         public static final int product_buy_entry=0x7f06005c;
-        public static final int product_deadline=0x7f0600af;
-        public static final int product_model=0x7f0600ac;
-        public static final int product_model_input=0x7f0600a6;
-        public static final int product_sn_input=0x7f0600a7;
-        public static final int product_tel_input=0x7f0600a8;
-        public static final int product_time=0x7f0600ad;
-        public static final int product_type_input=0x7f0600a9;
-        public static final int product_where=0x7f0600ae;
+        public static final int product_deadline=0x7f0600b2;
+        public static final int product_model=0x7f0600af;
+        public static final int product_model_input=0x7f0600a9;
+        public static final int product_sn_input=0x7f0600aa;
+        public static final int product_tel_input=0x7f0600ab;
+        public static final int product_time=0x7f0600b0;
+        public static final int product_type_input=0x7f0600ac;
+        public static final int product_where=0x7f0600b1;
         public static final int progressbar=0x7f060055;
         public static final int progressbarLayout=0x7f060054;
         public static final int pwd=0x7f06005e;
         public static final int quit=0x7f060021;
         public static final int restart_preview=0x7f060022;
-        public static final int result_button_view=0x7f060084;
-        public static final int result_view=0x7f06007f;
+        public static final int result_button_view=0x7f060087;
+        public static final int result_view=0x7f060082;
         public static final int return_scan_result=0x7f060023;
         public static final int right=0x7f060011;
         public static final int scan_iamge=0x7f060059;
@@ -1340,29 +1344,29 @@ containing a value of this type.
         public static final int search_book_contents_failed=0x7f060024;
         public static final int search_book_contents_succeeded=0x7f060025;
         public static final int selected_view=0x7f060015;
-        public static final int shopper_button=0x7f060085;
+        public static final int shopper_button=0x7f060088;
         public static final int showCustom=0x7f060008;
         public static final int showHome=0x7f060005;
         public static final int showTitle=0x7f060007;
-        public static final int slidingmenumain=0x7f0600b0;
-        public static final int status_text_view=0x7f060087;
-        public static final int status_view=0x7f060086;
-        public static final int status_view_flashlight=0x7f060088;
+        public static final int slidingmenumain=0x7f0600b3;
+        public static final int status_text_view=0x7f06008a;
+        public static final int status_view=0x7f060089;
+        public static final int status_view_flashlight=0x7f06008b;
         public static final int tabMode=0x7f060003;
         public static final int tabs=0x7f060057;
         public static final int tel=0x7f06005d;
-        public static final int title=0x7f060066;
-        public static final int title_bar_layout=0x7f060089;
+        public static final int title=0x7f060069;
+        public static final int title_bar_layout=0x7f06008c;
         public static final int title_logo=0x7f060048;
         public static final int title_scan_button=0x7f06005a;
-        public static final int type_text_view=0x7f060082;
+        public static final int type_text_view=0x7f060085;
         public static final int useLogo=0x7f060004;
-        public static final int usr_name=0x7f060061;
-        public static final int usr_pwd=0x7f060062;
-        public static final int usr_repwd=0x7f060063;
-        public static final int usr_tel=0x7f060064;
-        public static final int usr_validate=0x7f060065;
-        public static final int viewfinder_view=0x7f06007e;
+        public static final int usr_name=0x7f060064;
+        public static final int usr_pwd=0x7f060065;
+        public static final int usr_repwd=0x7f060066;
+        public static final int usr_tel=0x7f060067;
+        public static final int usr_validate=0x7f060068;
+        public static final int viewfinder_view=0x7f060081;
         public static final int wrap_content=0x7f060000;
     }
     public static final class integer {
@@ -1391,45 +1395,47 @@ containing a value of this type.
         public static final int abs__search_view=0x7f030013;
         public static final int abs__simple_dropdown_hint=0x7f030014;
         public static final int activity_choose_address=0x7f030015;
-        public static final int activity_choose_devices=0x7f030016;
+        public static final int activity_choose_devices_fragment=0x7f030016;
         public static final int activity_choose_devices_main=0x7f030017;
         public static final int activity_choose_devices_pinpai=0x7f030018;
         public static final int activity_install_20140418=0x7f030019;
         public static final int activity_login_20140415=0x7f03001a;
         public static final int activity_login_confirm=0x7f03001b;
         public static final int activity_login_detail_20140415=0x7f03001c;
-        public static final int activity_main=0x7f03001d;
-        public static final int activity_my_card=0x7f03001e;
-        public static final int activity_new_card=0x7f03001f;
-        public static final int activity_register=0x7f030020;
-        public static final int activity_register_confirm=0x7f030021;
-        public static final int activity_repair=0x7f030022;
-        public static final int activity_repair_20140418=0x7f030023;
-        public static final int ads=0x7f030024;
-        public static final int capture=0x7f030025;
-        public static final int child_textview=0x7f030026;
-        public static final int common_button_title=0x7f030027;
-        public static final int content_frame=0x7f030028;
-        public static final int dashboard_layout=0x7f030029;
-        public static final int devices_list_item=0x7f03002a;
-        public static final int dialog_use_mobile_confirm=0x7f03002b;
-        public static final int dot=0x7f03002c;
-        public static final int grid_item=0x7f03002d;
-        public static final int group_textview=0x7f03002e;
-        public static final int history_list_item=0x7f03002f;
-        public static final int home_pro_city_dis=0x7f030030;
-        public static final int layout_popupwindow=0x7f030031;
-        public static final int menu_frame=0x7f030032;
-        public static final int model_list_item=0x7f030033;
-        public static final int pcd_edit=0x7f030034;
-        public static final int pcd_edit_info=0x7f030035;
-        public static final int people_contact_info=0x7f030036;
-        public static final int product_create_info=0x7f030037;
-        public static final int product_list_item=0x7f030038;
-        public static final int product_repair_info=0x7f030039;
-        public static final int sherlock_spinner_dropdown_item=0x7f03003a;
-        public static final int sherlock_spinner_item=0x7f03003b;
-        public static final int slidingmenumain=0x7f03003c;
+        public static final int activity_login_or_update_layout=0x7f03001d;
+        public static final int activity_main=0x7f03001e;
+        public static final int activity_my_card=0x7f03001f;
+        public static final int activity_new_card=0x7f030020;
+        public static final int activity_register=0x7f030021;
+        public static final int activity_register_confirm=0x7f030022;
+        public static final int activity_repair=0x7f030023;
+        public static final int activity_repair_20140418=0x7f030024;
+        public static final int ads=0x7f030025;
+        public static final int capture=0x7f030026;
+        public static final int child_textview=0x7f030027;
+        public static final int common_button_title=0x7f030028;
+        public static final int content_frame=0x7f030029;
+        public static final int dashboard_layout=0x7f03002a;
+        public static final int devices_list_item=0x7f03002b;
+        public static final int dialog_use_mobile_confirm=0x7f03002c;
+        public static final int dot=0x7f03002d;
+        public static final int grid_item=0x7f03002e;
+        public static final int group_textview=0x7f03002f;
+        public static final int history_list_item=0x7f030030;
+        public static final int home_pro_city_dis=0x7f030031;
+        public static final int home_pro_city_dis_autocomplete=0x7f030032;
+        public static final int layout_popupwindow=0x7f030033;
+        public static final int menu_frame=0x7f030034;
+        public static final int model_list_item=0x7f030035;
+        public static final int pcd_edit=0x7f030036;
+        public static final int pcd_edit_info=0x7f030037;
+        public static final int people_contact_info=0x7f030038;
+        public static final int product_create_info=0x7f030039;
+        public static final int product_list_item=0x7f03003a;
+        public static final int product_repair_info=0x7f03003b;
+        public static final int sherlock_spinner_dropdown_item=0x7f03003c;
+        public static final int sherlock_spinner_item=0x7f03003d;
+        public static final int slidingmenumain=0x7f03003e;
     }
     public static final class menu {
         public static final int new_card_activity_menu=0x7f0e0000;
@@ -1575,8 +1581,18 @@ containing a value of this type.
         public static final int msg_install_google_shopper=0x7f0b00a3;
         public static final int msg_intent_failed=0x7f0b0017;
         public static final int msg_local_intent_failed=0x7f0b00a4;
+        /**  qrcode scan part end 
+         */
+        public static final int msg_login_confirm_success=0x7f0b00b3;
+        public static final int msg_login_dialog_title=0x7f0b00b5;
+        public static final int msg_login_download_accountinfo_wait=0x7f0b00b7;
+        public static final int msg_login_download_addressinfo_wait=0x7f0b00b8;
+        public static final int msg_login_download_baoxiuinfo_wait=0x7f0b00b9;
+        public static final int msg_login_save_success=0x7f0b00b4;
         public static final int msg_no_sdcard=0x7f0b002e;
         public static final int msg_not_our_results=0x7f0b00a7;
+        public static final int msg_op_canceled=0x7f0b00ba;
+        public static final int msg_op_successed=0x7f0b00bb;
         public static final int msg_progressdialog_wait=0x7f0b007c;
         public static final int msg_save_ok=0x7f0b00b0;
         public static final int msg_sd_unavailable=0x7f0b00b1;
@@ -1584,6 +1600,7 @@ containing a value of this type.
         public static final int msg_share_subject_line=0x7f0b009a;
         public static final int msg_sure=0x7f0b00af;
         public static final int msg_unsupport_operation=0x7f0b002d;
+        public static final int msg_update_dialog_title=0x7f0b00b6;
         public static final int my_home=0x7f0b007e;
         public static final int name=0x7f0b0077;
         public static final int parent_home=0x7f0b007f;
@@ -1683,6 +1700,7 @@ containing a value of this type.
         public static final int ProductInfo_Repair=0x7f0c0067;
         public static final int ProductInfoInput=0x7f0c0062;
         public static final int ProductInfoInput_Repair=0x7f0c0066;
+        public static final int ProductInfoInputHomePlace=0x7f0c006d;
         public static final int ProductInfoInputNew=0x7f0c0063;
         public static final int ProductInfoInputPlace=0x7f0c0065;
         public static final int ProductInfoInputValidate=0x7f0c0064;
diff --git a/gen/com/shwy/bestjoy/bjnotecommonlibrary/R.java b/gen/com/shwy/bestjoy/bjnotecommonlibrary/R.java
index 70c2b3c..5d65fea 100644
--- a/gen/com/shwy/bestjoy/bjnotecommonlibrary/R.java
+++ b/gen/com/shwy/bestjoy/bjnotecommonlibrary/R.java
@@ -12,14 +12,14 @@ public final class R {
 		public static final int phoneClickableSpan = 0x7f0d0001;
 	}
 	public static final class drawable {
-		public static final int ic_launcher = 0x7f02008f;
+		public static final int ic_launcher = 0x7f020090;
 	}
 	public static final class id {
-		public static final int checkbox = 0x7f060096;
-		public static final int title = 0x7f060066;
+		public static final int checkbox = 0x7f060099;
+		public static final int title = 0x7f060069;
 	}
 	public static final class layout {
-		public static final int dialog_use_mobile_confirm = 0x7f03002b;
+		public static final int dialog_use_mobile_confirm = 0x7f03002c;
 	}
 	public static final class string {
 		public static final int app_name = 0x7f0b000d;
diff --git a/project.properties b/project.properties
index 8a54aa2..103d3f3 100644
--- a/project.properties
+++ b/project.properties
@@ -14,5 +14,5 @@
 target=android-19
 android.library.reference.1=../BjnoteCommonLibrary
 android.library.reference.2=../ActionBarSherlock/actionbarsherlock
-android.library.reference.3=../SlidingMenu/library
+android.library.reference.3=../slidemenu/library
 proguard.config=proguard.cfg
diff --git a/res/layout/activity_login_or_update_layout.xml b/res/layout/activity_login_or_update_layout.xml
new file mode 100644
index 0000000..e2ab571
--- /dev/null
+++ b/res/layout/activity_login_or_update_layout.xml
@@ -0,0 +1,22 @@
+<?xml version="1.0" encoding="utf-8"?>
+<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
+    android:layout_width="180dip"
+    android:layout_height="180dip"
+    android:gravity="center"
+    android:layout_gravity="center"
+    android:orientation="vertical"
+    android:background="@color/light_black" >
+    
+    <ProgressBar android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:indeterminate="false"
+        style="@android:style/Widget.ProgressBar.Large"/>
+    <TextView android:layout_width="wrap_content"
+        android:layout_marginTop="4dip"
+        android:layout_height="wrap_content"
+        android:textColor="@color/wt"
+        android:textSize="16sp"
+        android:id="@+id/title"
+        android:text="@string/msg_login_download_baoxiuinfo_wait"/>
+
+</LinearLayout>
diff --git a/res/values/strings.xml b/res/values/strings.xml
index 8cb2090..d57fd0d 100644
--- a/res/values/strings.xml
+++ b/res/values/strings.xml
@@ -178,5 +178,13 @@
   
   
   <string name="msg_login_confirm_success">登录成功，现在可以开始使用本软件了</string>
+  <string name="msg_login_save_success">账户初始化失败，请再次尝试...</string>
+  <string name="msg_login_dialog_title">账户登录</string>
+   <string name="msg_update_dialog_title">账户更新</string>
+  <string name="msg_login_download_accountinfo_wait">正在载入账户信息....</string>
+  <string name="msg_login_download_addressinfo_wait">正在载入家信息....</string>
+  <string name="msg_login_download_baoxiuinfo_wait">正在载入保修卡信息....</string>
+  <string name="msg_op_canceled">操作取消</string>
+  <string name="msg_op_successed">操作成功</string>
     
 </resources>
diff --git a/src/com/bestjoy/app/haierwarrantycard/account/AccountObject.java b/src/com/bestjoy/app/haierwarrantycard/account/AccountObject.java
index f39c8d2..c681669 100644
--- a/src/com/bestjoy/app/haierwarrantycard/account/AccountObject.java
+++ b/src/com/bestjoy/app/haierwarrantycard/account/AccountObject.java
@@ -62,8 +62,12 @@ public class AccountObject implements InfoInterface{
 	/**登陆时候服务器返回的数据*/
 	public String mStatusMessage;
 	
+	/**我的家信息*/
 	public List<HomeObject> mAccountHomes = new LinkedList<HomeObject>();
 	
+	/**我的保修卡信息*/
+	public List<BaoxiuCardObject> mBaoxiuCards = new LinkedList<BaoxiuCardObject>();
+	
 	public boolean isLogined() {
 		return mStatusCode != 0;
 	}
@@ -80,9 +84,9 @@ public class AccountObject implements InfoInterface{
 					return null;
 				}
 				haierAccount.mAccountId = Long.parseLong(idStr);
-				DebugUtils.logD(TAG, "getHaierAccountFromDatabase accountId is " + haierAccount.mAccountId);
 				if (haierAccount.mAccountId <= 0) {
-					
+					DebugUtils.logD(TAG, "getHaierAccountFromDatabase accountId is " + haierAccount.mAccountId);
+					return null;
 				}
 				haierAccount.mAccountUid = c.getLong(KEY_MD);
 				haierAccount.mAccountName = c.getString(KEY_NAME);
diff --git a/src/com/bestjoy/app/haierwarrantycard/account/AccountParser.java b/src/com/bestjoy/app/haierwarrantycard/account/AccountParser.java
index 18435a5..e5fabc3 100644
--- a/src/com/bestjoy/app/haierwarrantycard/account/AccountParser.java
+++ b/src/com/bestjoy/app/haierwarrantycard/account/AccountParser.java
@@ -63,6 +63,9 @@ public class AccountParser extends InfoInterfaceImpl{
 			}
 			//解析address
 			parseAddress(jsonObject, accountObject);
+			
+			//解析保修卡
+			parseBaoxiuCards(jsonObject, accountObject);
 		} catch (JSONException e) {
 			e.printStackTrace();
 		}
@@ -101,7 +104,7 @@ public class AccountParser extends InfoInterfaceImpl{
 	 * @throws JSONException
 	 */
 	public static void parseAddress(JSONObject jsonObject, AccountObject accountObject) throws JSONException {
-		//解析userdata
+		//解析addresses
 		JSONArray addresses = jsonObject.getJSONArray("address");
 		accountObject.mAccountHomes.clear();
 		if (addresses != null) {
@@ -116,4 +119,21 @@ public class AccountParser extends InfoInterfaceImpl{
 			accountObject.mAccountHomeCount = accountObject.mAccountHomes.size();
 		}
 	}
+	
+	public static void parseBaoxiuCards(JSONObject jsonObject, AccountObject accountObject) throws JSONException {
+		//解析baoxiu
+		JSONArray baoxiuCards = jsonObject.getJSONArray(BaoxiuCardObject.JSONOBJECT_NAME);
+		accountObject.mBaoxiuCards.clear();
+		if (baoxiuCards != null) {
+			int len = baoxiuCards.length();
+			BaoxiuCardObject baoxiuCardObject = null;
+			for(int index=0; index < len; index++) {
+				baoxiuCardObject = BaoxiuCardObject.parseBaoxiuCards(baoxiuCards.getJSONObject(index), accountObject);
+				if (baoxiuCardObject != null) {
+					accountObject.mBaoxiuCards.add(baoxiuCardObject);
+				}
+			}
+		}
+	}
+	
 }
diff --git a/src/com/bestjoy/app/haierwarrantycard/account/BaoxiuCardObject.java b/src/com/bestjoy/app/haierwarrantycard/account/BaoxiuCardObject.java
new file mode 100644
index 0000000..be575fc
--- /dev/null
+++ b/src/com/bestjoy/app/haierwarrantycard/account/BaoxiuCardObject.java
@@ -0,0 +1,84 @@
+package com.bestjoy.app.haierwarrantycard.account;
+
+import org.json.JSONException;
+import org.json.JSONObject;
+
+import android.content.ContentResolver;
+import android.content.ContentValues;
+
+import com.shwy.bestjoy.utils.InfoInterfaceImpl;
+/**
+ * 保修卡对象
+ * @author chenkai
+ * 
+ * "baoxiu": [
+        {
+            "LeiXin": "类型", 
+            "PinPai": "品牌", 
+            "XingHao": "型号", 
+            "SHBianHao": "12344", 
+            "BXPhone": "400-20098000",  //保修电话
+            "FPaddr": "图片地址（注意替换为ServerIP/Fapiao/20140419/10665de14261e416423e82f725bf6689.jpg", 
+            "BuyDate": "20140812", 
+            "BuyPrice": "125", 
+            "BuyTuJing": "苏宁", 
+            "YanBaoTime": "1年", 
+            "YanBaoDanWei": "苏宁", 
+            "UID": 1, 
+            "AID": 1, 
+            "BID": 1
+        }
+    ]
+ *
+ */
+public class BaoxiuCardObject extends InfoInterfaceImpl {
+	public static final String JSONOBJECT_NAME = "baoxiu";
+	public String mLeiXin;
+	public String mPinPai;
+	public String mXingHao;
+	public String mSHBianHao;
+	public String mBXPhone;
+	public String mFPaddr;
+	public String mBuyDate;
+	public String mBuyPrice;
+	public String mBuyTuJing;
+	public String mYanBaoTime;
+	public String mYanBaoDanWei;
+	public long mUID, mAID, mBID;
+	
+	public static BaoxiuCardObject parseBaoxiuCards(JSONObject jsonObject, AccountObject accountObject) throws JSONException {
+		BaoxiuCardObject cardObject = new BaoxiuCardObject();
+		cardObject.mLeiXin = jsonObject.getString("LeiXin");
+		cardObject.mPinPai = jsonObject.getString("PinPai");
+		cardObject.mXingHao = jsonObject.getString("XingHao");
+		cardObject.mSHBianHao = jsonObject.getString("SHBianHao");
+		
+		cardObject.mBXPhone = jsonObject.getString("BXPhone");
+		cardObject.mFPaddr = jsonObject.getString("FPaddr");
+		cardObject.mBuyDate = jsonObject.getString("BuyDate");
+		cardObject.mBuyPrice = jsonObject.getString("BuyPrice");
+		
+		cardObject.mBuyTuJing = jsonObject.getString("BuyTuJing");
+		cardObject.mYanBaoTime = jsonObject.getString("YanBaoTime");
+		cardObject.mYanBaoDanWei = jsonObject.getString("YanBaoDanWei");
+		
+		
+		cardObject.mUID = jsonObject.getLong("UID");
+		cardObject.mAID = jsonObject.getLong("AID");
+		cardObject.mBID = jsonObject.getLong("BID");
+		return cardObject;
+	}
+	
+	@Override
+	public String toString() {
+		StringBuilder sb = new StringBuilder();
+		
+		return sb.toString();
+	}
+
+	@Override
+	public boolean saveInDatebase(ContentResolver cr, ContentValues addtion) {
+		return super.saveInDatebase(cr, addtion);
+	}
+
+}
diff --git a/src/com/bestjoy/app/haierwarrantycard/account/HaierAccountManager.java b/src/com/bestjoy/app/haierwarrantycard/account/HaierAccountManager.java
index 08ef13c..8df73fe 100644
--- a/src/com/bestjoy/app/haierwarrantycard/account/HaierAccountManager.java
+++ b/src/com/bestjoy/app/haierwarrantycard/account/HaierAccountManager.java
@@ -23,6 +23,12 @@ public class HaierAccountManager {
 		mSharedPreferences = mContext.getSharedPreferences(TAG, Context.MODE_PRIVATE);
 	}
 	
+	public void initAccountObject() {
+		if (mHaierAccount == null) {
+			mHaierAccount = AccountObject.getHaierAccountFromDatabase(mContext);
+		}
+	}
+	
 	public boolean hasLoginned() {
 		return mHaierAccount != null && mHaierAccount.mAccountId > 0;
 	}
diff --git a/src/com/bestjoy/app/haierwarrantycard/account/HomeParser.java b/src/com/bestjoy/app/haierwarrantycard/account/HomeParser.java
index 5173b0a..2f545e2 100644
--- a/src/com/bestjoy/app/haierwarrantycard/account/HomeParser.java
+++ b/src/com/bestjoy/app/haierwarrantycard/account/HomeParser.java
@@ -10,7 +10,7 @@ public class HomeParser extends InfoInterfaceImpl{
 	
 	
 	/**
-	 * {"ShenFen":"江苏宝应宝应大道","City":"扬州","QuXian":"江苏宝应宝应大道","DetailAddr":"江苏宝应宝应大道","UID":1,"AID":1}
+	 * {"ShenFen":"江苏宝应宝应大道","City":"扬州","QuXian":"江苏宝应宝应大道","DetailAddr":"江苏宝应宝应大道","UID":1,"AID":1,"Tag": "第一个家"}
 	 * @param jsonObject
 	 * @param accountObject
 	 * @throws JSONException
@@ -24,6 +24,7 @@ public class HomeParser extends InfoInterfaceImpl{
 		
 		homeObject.mHomeUid = jsonObject.getLong("UID");
 		homeObject.mHomeAid = jsonObject.getLong("AID");
+		homeObject.mHomeName = jsonObject.getString("Tag");
 		return homeObject;
 	}
 	/**
diff --git a/src/com/bestjoy/app/haierwarrantycard/database/HaierDBHelper.java b/src/com/bestjoy/app/haierwarrantycard/database/HaierDBHelper.java
index 1cf13d9..524ee7a 100644
--- a/src/com/bestjoy/app/haierwarrantycard/database/HaierDBHelper.java
+++ b/src/com/bestjoy/app/haierwarrantycard/database/HaierDBHelper.java
@@ -60,42 +60,43 @@ private static final String TAG = "HaierDBHelper";
   /**详细地址*/
   public static final String HOME_DETAIL = "home_detail";
   public static final String HOME_DEFAULT = "isDefault";
-  public static final String MODIFIED = "modified";
   /**我的家TAB位置,用户可以调整顺序*/
   public static final String POSITION = "position";
   
-  //devices table
-  public static final String TABLE_NAME_DEVICES = "devices";
+  //cards table
+  public static final String TABLE_NAME_DEVICES = "cards";
   /**所属家*/
   public static final String REF_HOME_ID = "home_id";
-  /**设别名称*/
-  public static final String DEVICE_NAME = "name";
+  /**名称*/
+  public static final String CARD_NAME = "name";
   /**设备类别，比如大类是电视剧*/
-  public static final String DEVICE_TYPE = "type";
+  public static final String CARD_TYPE = "LeiXin";
   /**品牌*/
-  public static final String DEVICE_BRAND = "brand";
+  public static final String CARD_PINPAI = "PinPai";
   /**商品编号*/
-  public static final String DEVICE_SERIAL = "serial";
+  public static final String CARD_SERIAL = "SHBianHao";
   /**型号*/
-  public static final String DEVICE_MODEL = "model";
-  /**售后电话*/
-  public static final String DEVICE_SOLD_TEL = "tel";
+  public static final String CARD_MODEL = "XingHao";
+  /**保修电话*/
+  public static final String CARD_BXPhone = "BXPhone";
+  /**发票路径*/
+  public static final String CARD_BILL = "FPaddr";
   /**购买价格*/
-  public static final String DEVICE_COST = "cost";
+  public static final String CARD_PRICE = "BuyPrice";
   /**购买日期*/
-  public static final String DEVICE_BUY_DATE = "buyDate";
+  public static final String CARD_BUT_DATE = "BuyDate";
   /**购买途径*/
-  public static final String DEVICE_BUY_WHERE = "buyWhere";
+  public static final String CARD_BUY_TUJING = "BuyTuJing";
   /**延保时间*/
-  public static final String DEVICE_BUY_EXTENDED = "buyExtended";
+  public static final String CARD_YANBAO_TIME = "YanBaoTime";
+  /**延保单位*/
+  public static final String CARD_YANBAO_TIME_COMPANY = "YanBaoDanWei";
+  /**延保单位电话*/
+  public static final String CARD_YANBAO_TIME_COPMANY_TEL = "YanBaoDanWeiCommanyTel";
   /**整机保修*/
   public static final String DEVICE_WARRANTY_PERIOD = "warranty_period";
   /**配件保修*/
   public static final String DEVICE_COMPONENT_WARRANTY_PERIOD = "component_warranty_period";
-  /**延保单位*/
-  public static final String DEVICE_BUY_EXTENDED_COMPANY = "extendedCommany";
-  /**延保单位电话*/
-  public static final String DEVICE_BUY_EXTENDED_COPMANY_TEL = "extendedCommanyTel";
   
   //这里是设备表的扩展，如遥控器
   
@@ -306,21 +307,21 @@ private static final String TAG = "HaierDBHelper";
 	            "_id INTEGER PRIMARY KEY AUTOINCREMENT, " +
 	            REF_ACCOUNT_ID + " TEXT, " +  //账户id
 	            REF_HOME_ID + " TEXT, " +     //家id
-	            DEVICE_TYPE + " TEXT, " +
-	            DEVICE_NAME + " TEXT, " +
-	            DEVICE_BRAND + " TEXT, " +
-	            DEVICE_MODEL + " TEXT, " +
-	            DEVICE_SERIAL + " TEXT, " +
-	            DEVICE_SOLD_TEL + " TEXT, " +
-	            DEVICE_BUY_DATE + " TEXT, " +
-	            DEVICE_COST + " TEXT, " +
-	            DEVICE_BUY_WHERE + " TEXT, " +
-	            DEVICE_BUY_EXTENDED + " TEXT, " +
-	            DEVICE_BUY_EXTENDED_COMPANY + " TEXT, " +
-	            DEVICE_BUY_EXTENDED_COPMANY_TEL + " TEXT, " +
+	            CARD_TYPE + " TEXT, " +
+	            CARD_NAME + " TEXT, " +
+	            CARD_PINPAI + " TEXT, " +
+	            CARD_MODEL + " TEXT, " +
+	            CARD_SERIAL + " TEXT, " +
+	            CARD_BXPhone + " TEXT, " +
+	            CARD_BUT_DATE + " TEXT, " +
+	            CARD_PRICE + " TEXT, " +
+	            CARD_BUY_TUJING + " TEXT, " +
+	            CARD_YANBAO_TIME + " TEXT, " +
+	            CARD_YANBAO_TIME_COMPANY + " TEXT, " +
+	            CARD_YANBAO_TIME_COPMANY_TEL + " TEXT, " +
 	            DEVICE_WARRANTY_PERIOD + " TEXT, " +
 	            DEVICE_COMPONENT_WARRANTY_PERIOD + " TEXT, " +
-	            MODIFIED + " TEXT" +
+	            CONTACT_DATE + " TEXT" +
 	            ");");
 	  createTriggerForDeviceTable(sqLiteDatabase);
   }
diff --git a/src/com/bestjoy/app/haierwarrantycard/ui/LoginActivity.java b/src/com/bestjoy/app/haierwarrantycard/ui/LoginActivity.java
index 1dc1c3e..61ffd5f 100644
--- a/src/com/bestjoy/app/haierwarrantycard/ui/LoginActivity.java
+++ b/src/com/bestjoy/app/haierwarrantycard/ui/LoginActivity.java
@@ -1,15 +1,8 @@
 package com.bestjoy.app.haierwarrantycard.ui;
 
-import java.io.IOException;
-import java.io.InputStream;
-
-import org.apache.http.client.ClientProtocolException;
-
-import android.app.ProgressDialog;
+import android.app.Activity;
 import android.content.Context;
-import android.content.DialogInterface;
 import android.content.Intent;
-import android.os.AsyncTask;
 import android.os.Bundle;
 import android.text.TextUtils;
 import android.view.View;
@@ -21,16 +14,14 @@ import com.actionbarsherlock.view.Menu;
 import com.bestjoy.app.haierwarrantycard.MyApplication;
 import com.bestjoy.app.haierwarrantycard.R;
 import com.bestjoy.app.haierwarrantycard.account.AccountObject;
-import com.bestjoy.app.haierwarrantycard.account.AccountParser;
 import com.bestjoy.app.haierwarrantycard.account.HaierAccountManager;
 import com.bestjoy.app.haierwarrantycard.utils.DebugUtils;
-import com.shwy.bestjoy.utils.AsyncTaskUtils;
-import com.shwy.bestjoy.utils.NetworkUtils;
 
 public class LoginActivity extends BaseActionbarActivity implements View.OnClickListener{
 	private static final String TAG = "NewCardActivity";
 
 	private TextView mRegisterButton;
+	private static final int REQUEST_LOGIN = 1;
 	private Button mLoginBtn;
 	private EditText mTelInput, mPasswordInput;
 	public static AccountObject mAccountObject;
@@ -86,7 +77,7 @@ public class LoginActivity extends BaseActionbarActivity implements View.OnClick
 				String pwd = mPasswordInput.getText().toString().trim();
 				if (!TextUtils.isEmpty(tel) && !TextUtils.isEmpty(pwd)) {
 					HaierAccountManager.getInstance().saveLastUsrTel(tel);
-					loginAsync(tel, pwd);
+					startActivityForResult(LoginOrUpdateAccountDialog.createLoginOrUpdate(this, true, tel, pwd), REQUEST_LOGIN);
 				} else {
 					MyApplication.getInstance().showMessage(R.string.msg_input_usrtel_password);
 				}
@@ -95,93 +86,21 @@ public class LoginActivity extends BaseActionbarActivity implements View.OnClick
 		
 	}
 	
-	private LoginAsyncTask mLoginAsyncTask;
-	private ProgressDialog mLoginDialog;
-	private void loginAsync(String... param) {
-		AsyncTaskUtils.cancelTask(mLoginAsyncTask);
-		mLoginDialog = getProgressDialog();
-		if (mLoginDialog == null) {
-			showDialog(DIALOG_PROGRESS);
-			mLoginDialog = getProgressDialog();
-			mLoginDialog.setOnCancelListener(new DialogInterface.OnCancelListener() {
-				
-				@Override
-				public void onCancel(DialogInterface dialog) {
-					AsyncTaskUtils.cancelTask(mLoginAsyncTask);
-				}
-			});
-		} else {
-			if (!mLoginDialog.isShowing()) {
-				mLoginDialog.show();
-			}
-		}
-		mLoginAsyncTask = new LoginAsyncTask();
-		mLoginAsyncTask.execute(param);
-	}
-	private class LoginAsyncTask extends AsyncTask<String, Void, Void> {
-
-		private static final String URL = "http://115.29.231.29/Haier/login.ashx?";
-		private String mError;
-		@Override
-		protected Void doInBackground(String... params) {
-			mError = null;
-			mAccountObject = null;
-			InputStream is = null;
-			StringBuilder sb = new StringBuilder(URL);
-			sb.append("cell=").append(params[0])
-			.append("&pwd=");
-			try {
-				is = NetworkUtils.openContectionLocked(sb.toString(), params[1], null);
-				mAccountObject = AccountParser.parseJson(is);
-			} catch (ClientProtocolException e) {
-				e.printStackTrace();
-				mError = e.getMessage();
-			} catch (IOException e) {
-				e.printStackTrace();
-				mError = e.getMessage();
-			} finally {
-				NetworkUtils.closeInputStream(is);
-			}
-			return null;
-		}
-
-		@Override
-		protected void onPostExecute(Void result) {
-			super.onPostExecute(result);
-			if (mLoginDialog != null) {
-				mLoginDialog.hide();
-			}
-			
-			if (mError != null) {
-				MyApplication.getInstance().showMessage(mError);
-			} else if (mAccountObject != null) {
-				//如果登陆成功
-				if (mAccountObject.isLogined()) {
-					doContinue();
-				} else {
-					MyApplication.getInstance().showMessage(mAccountObject.mStatusMessage);
-				}
-			}
-		}
-
-		@Override
-		protected void onCancelled() {
-			super.onCancelled();
-			if (mLoginDialog != null) {
-				mLoginDialog.hide();
+	
+	@Override
+	public void onActivityResult(int requestCode, int resultCode, Intent data) {
+		if (requestCode == REQUEST_LOGIN) {
+			if (resultCode == Activity.RESULT_OK) {
+				// login successfully
+				MyApplication.getInstance().showMessage(R.string.msg_login_confirm_success);
+				MyChooseDevicesActivity.startIntent(mContext, null);
+				finish();
 			}
+		} else {
+			super.onActivityResult(requestCode, resultCode, data);
 		}
-		
 	}
 	
-	/**
-	 * 登陆成功后的下一步操作
-	 */
-	private void doContinue() {
-		LoginConfirmAddressActivity.startIntent(this);
-	}
-	
-	
 	public static void startIntent(Context context) {
 		Intent intent = new Intent(context, LoginActivity.class);
 		context.startActivity(intent);
diff --git a/src/com/bestjoy/app/haierwarrantycard/ui/LoginOrUpdateAccountDialog.java b/src/com/bestjoy/app/haierwarrantycard/ui/LoginOrUpdateAccountDialog.java
new file mode 100644
index 0000000..d7f06b2
--- /dev/null
+++ b/src/com/bestjoy/app/haierwarrantycard/ui/LoginOrUpdateAccountDialog.java
@@ -0,0 +1,165 @@
+package com.bestjoy.app.haierwarrantycard.ui;
+
+import java.io.IOException;
+import java.io.InputStream;
+
+import org.apache.http.client.ClientProtocolException;
+
+import android.app.Activity;
+import android.app.ProgressDialog;
+import android.content.Context;
+import android.content.DialogInterface;
+import android.content.Intent;
+import android.os.AsyncTask;
+import android.os.Bundle;
+import android.widget.TextView;
+
+import com.bestjoy.app.haierwarrantycard.MyApplication;
+import com.bestjoy.app.haierwarrantycard.R;
+import com.bestjoy.app.haierwarrantycard.account.AccountObject;
+import com.bestjoy.app.haierwarrantycard.account.AccountParser;
+import com.bestjoy.app.haierwarrantycard.account.HaierAccountManager;
+import com.bestjoy.app.haierwarrantycard.utils.DebugUtils;
+import com.shwy.bestjoy.utils.AsyncTaskUtils;
+import com.shwy.bestjoy.utils.Intents;
+import com.shwy.bestjoy.utils.NetworkUtils;
+/**
+ * 这个类用来更新和登录账户使用。
+ * @author chenkai
+ *
+ */
+public class LoginOrUpdateAccountDialog extends Activity{
+
+	public static final String SERVICE_URL = "http://115.29.231.29/Haier/login.ashx?";
+	private static final String TAG = "LoginOrUpdateAccountDialog";
+	private AccountObject mAccountObject;
+	private String mTel, mPwd;
+	private boolean mIsLogin = false;
+	private TextView mStatusView;
+	
+	@Override
+	protected void onCreate(Bundle savedInstanceState) {
+		super.onCreate(savedInstanceState);
+		setContentView(R.layout.activity_login_or_update_layout);
+		mStatusView = (TextView) findViewById(R.id.title);
+		Intent intent = getIntent();
+		mIsLogin = intent.getBooleanExtra(Intents.EXTRA_TYPE, true);
+		mTel = intent.getStringExtra(Intents.EXTRA_TEL);
+		mPwd = intent.getStringExtra(Intents.EXTRA_PASSWORD);
+		loginAsync();
+	}
+
+	private LoginAsyncTask mLoginAsyncTask;
+	private ProgressDialog mLoginDialog;
+	private void loginAsync() {
+		AsyncTaskUtils.cancelTask(mLoginAsyncTask);
+		if (mLoginDialog == null) {
+			mLoginDialog.setOnCancelListener(new DialogInterface.OnCancelListener() {
+				
+				@Override
+				public void onCancel(DialogInterface dialog) {
+					AsyncTaskUtils.cancelTask(mLoginAsyncTask);
+				}
+			});
+		} else {
+			if (!mLoginDialog.isShowing()) {
+				mLoginDialog.show();
+			}
+		}
+		mLoginAsyncTask = new LoginAsyncTask();
+		mLoginAsyncTask.execute();
+	}
+	private class LoginAsyncTask extends AsyncTask<Void, Void, Void> {
+
+		private String _error;
+		InputStream _is = null;
+		@Override
+		protected Void doInBackground(Void... params) {
+			_error = null;
+			mAccountObject = null;
+			_is = null;
+			StringBuilder sb = new StringBuilder(SERVICE_URL);
+			sb.append("cell=").append(mTel)
+			.append("&pwd=");
+			try {
+				_is = NetworkUtils.openContectionLocked(sb.toString(), mPwd, null);
+				mAccountObject = AccountParser.parseJson(_is);
+				if (mAccountObject.isLogined()) {
+					boolean saveAccountOk = HaierAccountManager.getInstance().saveAccountObject(LoginOrUpdateAccountDialog.this.getContentResolver(), mAccountObject);
+					if (!saveAccountOk) {
+						//登录成功了，但本地数据保存失败，通常不会走到这里
+						_error = LoginOrUpdateAccountDialog.this.getString(R.string.msg_login_save_success);
+					}
+				} 
+			} catch (ClientProtocolException e) {
+				e.printStackTrace();
+				_error = e.getMessage();
+			} catch (IOException e) {
+				e.printStackTrace();
+				_error = e.getMessage();
+			} finally {
+				NetworkUtils.closeInputStream(_is);
+			}
+			return null;
+		}
+
+		@Override
+		protected void onPostExecute(Void result) {
+			super.onPostExecute(result);
+			if (isCancelled()) {
+				//通常不走到这里
+				onCancelled();
+				return;
+			}
+			if (_error != null) {
+				MyApplication.getInstance().showMessage(_error);
+				setResult(Activity.RESULT_CANCELED);
+			} else if (mAccountObject != null) {
+				//如果登陆成功
+				if (mAccountObject.isLogined()) {
+					setResult(Activity.RESULT_OK);
+					finish();
+				} else {
+					MyApplication.getInstance().showMessage(mAccountObject.mStatusMessage);
+					setResult(Activity.RESULT_CANCELED);
+					finish();
+				}
+			}
+		}
+
+		@Override
+		protected void onCancelled() {
+			super.onCancelled();
+			MyApplication.getInstance().showMessage(R.string.msg_op_canceled);
+			setResult(Activity.RESULT_CANCELED);
+			finish();
+			
+		}
+		
+		public void cancelTask(boolean cancel) {
+			super.cancel(cancel);
+			//由于IO操作是不可中断的，所以我们这里关闭IO流来终止任务
+			NetworkUtils.closeInputStream(_is);
+			
+		}
+		
+	}
+	
+	@Override
+	public void onBackPressed() {
+		super.onBackPressed();
+		if (mLoginAsyncTask != null) {
+			mLoginAsyncTask.cancelTask(true);
+			DebugUtils.logD(TAG, "login or update is canceled by user");
+		}
+	}
+	
+	public static Intent createLoginOrUpdate(Context context, boolean login, String tel, String pwd) {
+		Intent intent = new Intent(context, LoginOrUpdateAccountDialog.class);
+		intent.putExtra(Intents.EXTRA_TYPE, login);
+		intent.putExtra(Intents.EXTRA_TEL, tel);
+		intent.putExtra(Intents.EXTRA_PASSWORD, pwd);
+		return intent;
+	}
+	
+}
